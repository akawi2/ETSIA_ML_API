  services:
  ga4-bridge:
    build: ./ga4_bridge
    ports:
      - "5000:5000"
    volumes:
      - ./metrics_catalog.json:/app/metrics_catalog.json
    environment:
      - GA4_MEASUREMENT_ID=${GA4_MEASUREMENT_ID}
      - GA4_API_SECRET=${GA4_API_SECRET}
    command: uvicorn main:app --host 0.0.0.0 --port 5000

  fastapi-app:
    build: ./fastapi_app
    ports:
      - "8000:8000"
    depends_on:
      - ga4-bridge
    environment:
      - BRIDGE_URL=http://ga4-bridge:5000/log_metric
    env_file:
      - .env
